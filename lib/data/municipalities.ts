/**
 * Municipality slug mapping
 * Maps Japanese municipality names to URL-friendly slugs
 */

const municipalitySlugMap: Record<string, string> = {
  // 東京都
  "千代田区": "chiyoda-ku",
  "中央区": "chuo-ku",
  "港区": "minato-ku",
  "新宿区": "shinjuku-ku",
  "文京区": "bunkyo-ku",
  "台東区": "taito-ku",
  "墨田区": "sumida-ku",
  "江東区": "koto-ku",
  "品川区": "shinagawa-ku",
  "目黒区": "meguro-ku",
  "大田区": "ota-ku",
  "世田谷区": "setagaya-ku",
  "渋谷区": "shibuya-ku",
  "中野区": "nakano-ku",
  "杉並区": "suginami-ku",
  "豊島区": "toshima-ku",
  "北区": "kita-ku",
  "荒川区": "arakawa-ku",
  "板橋区": "itabashi-ku",
  "練馬区": "nerima-ku",
  "足立区": "adachi-ku",
  "葛飾区": "katsushika-ku",
  "江戸川区": "edogawa-ku",
  "八王子市": "hachioji",
  "立川市": "tachikawa",
  "武蔵野市": "musashino",
  "三鷹市": "mitaka",
  "府中市": "fuchu",
  "町田市": "machida",

  // 神奈川県
  "横浜市中区": "yokohama-naka",
  "横浜市西区": "yokohama-nishi",
  "横浜市南区": "yokohama-minami",
  "横浜市旭区": "yokohama-asahi",
  "横浜市磯子区": "yokohama-isogo",
  "横浜市金沢区": "yokohama-kanazawa",
  "横浜市港北区": "yokohama-kohoku",
  "横浜市戸塚区": "yokohama-totsuka",
  "横浜市港南区": "yokohama-konan",
  "横浜市緑区": "yokohama-midori",
  "横浜市青葉区": "yokohama-aoba",
  "横浜市都筑区": "yokohama-tsuzuki",
  "横浜市神奈川区": "yokohama-kanagawa",
  "横浜市保土ケ谷区": "yokohama-hodogaya",
  "横浜市鶴見区": "yokohama-tsurumi",
  "横浜市泉区": "yokohama-izumi",
  "横浜市瀬谷区": "yokohama-seya",
  "横浜市栄区": "yokohama-sakae",
  "川崎市幸区": "kawasaki-saiwai",
  "川崎市中原区": "kawasaki-nakahara",
  "川崎市高津区": "kawasaki-takatsu",
  "川崎市宮前区": "kawasaki-miyamae",
  "川崎市多摩区": "kawasaki-tama",
  "川崎市麻生区": "kawasaki-asao",
  "川崎市川崎区": "kawasaki-kawasaki",
  "相模原市中央区": "sagamihara-chuo",
  "相模原市南区": "sagamihara-minami",
  "相模原市緑区": "sagamihara-midori",
  "平塚市": "hiratsuka",
  "厚木市": "atsugi",
  "藤沢市": "fujisawa",
  "横須賀市": "yokosuka",
  "小田原市": "odawara",
  "茅ヶ崎市": "chigasaki",

  // 大阪府
  "大阪市北区": "osaka-kita",
  "大阪市中央区": "osaka-chuo",
  "大阪市西区": "osaka-nishi",
  "大阪市天王寺区": "osaka-tennoji",
  "大阪市浪速区": "osaka-naniwa",
  "大阪市東淀川区": "osaka-higashiyodogawa",
  "大阪市生野区": "osaka-ikuno",
  "大阪市旭区": "osaka-asahi",
  "大阪市城東区": "osaka-joto",
  "大阪市阿倍野区": "osaka-abeno",
  "大阪市住吉区": "osaka-sumiyoshi",
  "大阪市東住吉区": "osaka-higashisumiyoshi",
  "大阪市西成区": "osaka-nishinari",
  "大阪市淀川区": "osaka-yodogawa",
  "大阪市鶴見区": "osaka-tsurumi",
  "大阪市住之江区": "osaka-suminoe",
  "大阪市平野区": "osaka-hirano",
  "大阪市福島区": "osaka-fukushima",
  "大阪市此花区": "osaka-konohana",
  "大阪市港区": "osaka-minato",
  "大阪市大正区": "osaka-taisho",
  "大阪市西淀川区": "osaka-nishiyodogawa",
  "大阪市東成区": "osaka-higashinari",
  "堺市堺区": "sakai-sakai",
  "堺市中区": "sakai-naka",
  "堺市東区": "sakai-higashi",
  "堺市西区": "sakai-nishi",
  "堺市南区": "sakai-minami",
  "堺市北区": "sakai-kita",
  "堺市美原区": "sakai-mihara",

  // 愛知県
  "名古屋市中区": "nagoya-naka",
  "名古屋市千種区": "nagoya-chikusa",
  "名古屋市東区": "nagoya-higashi",
  "名古屋市北区": "nagoya-kita",
  "名古屋市西区": "nagoya-nishi",
  "名古屋市中村区": "nagoya-nakamura",
  "名古屋市昭和区": "nagoya-showa",
  "名古屋市瑞穂区": "nagoya-mizuho",
  "名古屋市熱田区": "nagoya-atsuta",
  "名古屋市中川区": "nagoya-nakagawa",
  "名古屋市港区": "nagoya-minato",
  "名古屋市南区": "nagoya-minami",
  "名古屋市守山区": "nagoya-moriyama",
  "名古屋市緑区": "nagoya-midori",
  "名古屋市名東区": "nagoya-meito",
  "名古屋市天白区": "nagoya-tempaku",
  "豊橋市": "toyohashi",
  "春日井市": "kasugai",
  "豊田市": "toyota",
  "岡崎市": "okazaki",
  "一宮市": "ichinomiya",

  // 福岡県
  "福岡市博多区": "fukuoka-hakata",
  "福岡市中央区": "fukuoka-chuo",
  "福岡市西区": "fukuoka-nishi",
  "福岡市南区": "fukuoka-minami",
  "福岡市東区": "fukuoka-higashi",
  "福岡市城南区": "fukuoka-jonan",
  "福岡市早良区": "fukuoka-sawara",
  "北九州市門司区": "kitakyushu-moji",
  "北九州市小倉北区": "kitakyushu-kokurakita",
  "北九州市小倉南区": "kitakyushu-kokuraminami",
  "北九州市若松区": "kitakyushu-wakamatsu",
  "北九州市八幡東区": "kitakyushu-yahatahigashi",
  "北九州市八幡西区": "kitakyushu-yahatanishi",
  "北九州市戸畑区": "kitakyushu-tobata",
  "久留米市": "kurume",

  // 北海道
  "札幌市中央区": "sapporo-chuo",
  "札幌市北区": "sapporo-kita",
  "札幌市東区": "sapporo-higashi",
  "札幌市白石区": "sapporo-shiroishi",
  "札幌市豊平区": "sapporo-toyohira",
  "札幌市南区": "sapporo-minami",
  "札幌市西区": "sapporo-nishi",
  "札幌市厚別区": "sapporo-atsubetsu",
  "札幌市手稲区": "sapporo-teine",
  "札幌市清田区": "sapporo-kiyota",
  "旭川市": "asahikawa",
  "函館市": "hakodate",

  // 京都府
  "京都市中京区": "kyoto-nakagyo",
  "京都市北区": "kyoto-kita",
  "京都市上京区": "kyoto-kamigyo",
  "京都市左京区": "kyoto-sakyo",
  "京都市東山区": "kyoto-higashiyama",
  "京都市下京区": "kyoto-shimogyo",
  "京都市南区": "kyoto-minami",
  "京都市右京区": "kyoto-ukyo",
  "京都市伏見区": "kyoto-fushimi",
  "京都市山科区": "kyoto-yamashina",
  "京都市西京区": "kyoto-nishikyo",

  // 静岡県
  "浜松市中央区": "hamamatsu-chuo",

  // 石川県
  "金沢市": "kanazawa",

  // 大分県
  "大分市": "oita",

  // 岐阜県
  "岐阜市": "gifu",

  // 鹿児島県
  "鹿児島市": "kagoshima",

  // 高知県
  "高知市": "kochi",

  // 富山県
  "富山市": "toyama",
  "高岡市": "takaoka",

  // 群馬県
  "高崎市": "takasaki",

  // 山形県
  "山形市": "yamagata",
  "酒田市": "sakata",

  // 福井県
  "福井市": "fukui",

  // 三重県
  "津市": "tsu",

  // 宮崎県
  "宮崎市": "miyazaki",

  // 山口県
  "宇部市": "ube",

  // 鳥取県
  "米子市": "yonago",

  // 埼玉県
  "さいたま市大宮区": "saitama-omiya",
  "さいたま市浦和区": "saitama-urawa",
  "さいたま市中央区": "saitama-chuo",
  "さいたま市南区": "saitama-minami",
  "さいたま市北区": "saitama-kita",
  "さいたま市西区": "saitama-nishi",
  "さいたま市桜区": "saitama-sakura",
  "さいたま市見沼区": "saitama-minuma",
  "さいたま市緑区": "saitama-midori",
  "さいたま市岩槻区": "saitama-iwatsuki",
  "川口市": "kawaguchi",
  "所沢市": "tokorozawa",
  "川越市": "kawagoe",
  "越谷市": "koshigaya",
  "草加市": "soka",
  "春日部市": "kasukabe",
  "熊谷市": "kumagaya",
  "上尾市": "ageo",
  "朝霞市": "asaka",
  "戸田市": "toda",
  "入間市": "iruma",
  "蕨市": "warabi",
  "志木市": "shiki",
  "新座市": "niiza",
  "和光市": "wako",
  "ふじみ野市": "fujimino",
  "富士見市": "fujimi",
  "三郷市": "misato",
  "八潮市": "yashio",
  "吉川市": "yoshikawa",
  "久喜市": "kuki",
  "蓮田市": "hasuda",
  "幸手市": "satte",
  "白岡市": "shiraoka",
  "加須市": "kazo",
  "行田市": "gyoda",
  "羽生市": "hanyu",
  "鴻巣市": "konosu",
  "桶川市": "okegawa",
  "北本市": "kitamoto",
  "深谷市": "fukaya",
  "本庄市": "honjo",
  "東松山市": "higashimatsuyama",
  "坂戸市": "sakado",
  "鶴ヶ島市": "tsurugashima",
  "日高市": "hidaka",
  "飯能市": "hanno",
  "狭山市": "sayama",

  // 新潟県
  "新潟市中央区": "niigata-chuo",
  "新潟市北区": "niigata-kita",
  "新潟市東区": "niigata-higashi",
  "新潟市西区": "niigata-nishi",
  "新潟市南区": "niigata-minami",
  "新潟市秋葉区": "niigata-akiha",
  "新潟市江南区": "niigata-konan",
  "新潟市西蒲区": "niigata-nishikan",
  "長岡市": "nagaoka",
  "上越市": "joetsu",
  "三条市": "sanjo",
  "新発田市": "shibata",
  "柏崎市": "kashiwazaki",
  "燕市": "tsubame",
  "村上市": "murakami",
  "南魚沼市": "minamiuonuma",
  "佐渡市": "sado",
  "十日町市": "tokamachi",
  "見附市": "mitsuke",
  "小千谷市": "ojiya",
  "加茂市": "kamo",
  "五泉市": "gosen",
  "阿賀野市": "agano",
  "胎内市": "tainai",
  "魚沼市": "uonuma",
  "妙高市": "myoko",
  "糸魚川市": "itoigawa",

  // 長野県
  "長野市": "nagano",
  "松本市": "matsumoto",
  "上田市": "ueda",
  "岡谷市": "okaya",
  "飯田市": "iida",
  "諏訪市": "suwa",
  "須坂市": "suzaka",
  "小諸市": "komoro",
  "伊那市": "ina",
  "駒ヶ根市": "komagane",
  "中野市": "nakano",
  "大町市": "omachi",
  "飯山市": "iiyama",
  "茅野市": "chino",
  "塩尻市": "shiojiri",
  "佐久市": "saku",
  "千曲市": "chikuma",
  "東御市": "tomi",
  "安曇野市": "azumino",

  // 岡山県
  "岡山市北区": "okayama-kita",

  // 熊本県
  "熊本市東区": "kumamoto-higashi",
  "天草市": "amakusa",

  // 秋田県
  "秋田市": "akita",

  // 千葉県
  "千葉市中央区": "chiba-chuo",
  "千葉市花見川区": "chiba-hanamigawa",
  "千葉市稲毛区": "chiba-inage",
  "千葉市若葉区": "chiba-wakaba",
  "千葉市緑区": "chiba-midori",
  "千葉市美浜区": "chiba-mihama",
  "船橋市": "funabashi",
  "市川市": "ichikawa",
  "松戸市": "matsudo",
  "柏市": "kashiwa",
  "市原市": "ichihara",
  "八千代市": "yachiyo",
  "習志野市": "narashino",
  "浦安市": "urayasu",
  "佐倉市": "sakura",
  "流山市": "nagareyama",
  "我孫子市": "abiko",
  "鎌ケ谷市": "kamagaya",
  "君津市": "kimitsu",
  "木更津市": "kisarazu",
  "成田市": "narita",
  "野田市": "noda",
  "茂原市": "mobara",
  "四街道市": "yotsukaido",
  "袖ケ浦市": "sodegaura",
  "八街市": "yachimata",
  "印西市": "inzai",
  "白井市": "shiroi",
  "富里市": "tomisato",
  "南房総市": "minamiboso",
  "匝瑳市": "sosa",
  "香取市": "katori",
  "山武市": "sanmu",
  "いすみ市": "isumi",
  "大網白里市": "oamishirasato",

  // 茨城県
  "つくば市": "tsukuba",
  "水戸市": "mito",
  "日立市": "hitachi",
  "土浦市": "tsuchiura",
  "古河市": "koga",
  "石岡市": "ishioka",
  "結城市": "yuki",
  "龍ケ崎市": "ryugasaki",
  "下妻市": "shimotsuma",
  "常総市": "joso",
  "常陸太田市": "hitachiota",
  "高萩市": "takahagi",
  "北茨城市": "kitaibaraki",
  "笠間市": "kasama",
  "取手市": "toride",
  "牛久市": "ushiku",
  "ひたちなか市": "hitachinaka",
  "鹿嶋市": "kashima",
  "潮来市": "itako",
  "守谷市": "moriya",
  "常陸大宮市": "hitachiomiya",
  "那珂市": "naka",
  "筑西市": "chikusei",
  "坂東市": "bando",
  "稲敷市": "inashiki",
  "かすみがうら市": "kasumigaura",
  "桜川市": "sakuragawa",
  "神栖市": "kamisu",
  "行方市": "namegata",
  "鉾田市": "hokota",
  "つくばみらい市": "tsukubamirai",
  "小美玉市": "omitama",

  // 島根県
  "松江市": "matsue",

  // 愛媛県
  "松山市": "matsuyama",

  // 沖縄県
  "沖縄市": "okinawa",

  // 福島県
  "福島市": "fukushima",
  "郡山市": "koriyama",
  "いわき市": "iwaki",
  "会津若松市": "aizuwakamatsu",
  "白河市": "shirakawa",
  "須賀川市": "sukagawa",
  "喜多方市": "kitakata",
  "相馬市": "soma",
  "二本松市": "nihonmatsu",
  "田村市": "tamura",
  "南相馬市": "minamisoma",
  "伊達市": "date",
  "本宮市": "motomiya",

  // 宮城県
  "仙台市青葉区": "sendai-aoba",
  "仙台市宮城野区": "sendai-miyagino",
  "仙台市若林区": "sendai-wakabayashi",
  "仙台市太白区": "sendai-taihaku",
  "仙台市泉区": "sendai-izumi",
  "石巻市": "ishinomaki",
  "塩竈市": "shiogama",
  "気仙沼市": "kesennuma",
  "白石市": "shiroishi",
  "名取市": "natori",
  "角田市": "kakuda",
  "多賀城市": "tagajo",
  "岩沼市": "iwanuma",
  "登米市": "tome",
  "栗原市": "kurihara",
  "東松島市": "higashimatsushima",
  "大崎市": "osaki",
  "富谷市": "tomiya",

  // 岩手県
  "盛岡市": "morioka",
  "宮古市": "miyako",
  "大船渡市": "ofunato",
  "花巻市": "hanamaki",
  "北上市": "kitakami",
  "久慈市": "kuji",
  "遠野市": "tono",
  "一関市": "ichinoseki",
  "陸前高田市": "rikuzentakata",
  "釜石市": "kamaishi",
  "二戸市": "ninohe",
  "八幡平市": "hachimantai",
  "奥州市": "oshu",
  "滝沢市": "takizawa",

  // 兵庫県
  "神戸市東灘区": "kobe-higashinada",
  "神戸市灘区": "kobe-nada",
  "神戸市兵庫区": "kobe-hyogo",
  "神戸市長田区": "kobe-nagata",
  "神戸市須磨区": "kobe-suma",
  "神戸市垂水区": "kobe-tarumi",
  "神戸市北区": "kobe-kita",
  "神戸市中央区": "kobe-chuo",
  "神戸市西区": "kobe-nishi",
  "姫路市": "himeji",
  "尼崎市": "amagasaki",
  "明石市": "akashi",
  "西宮市": "nishinomiya",
  "芦屋市": "ashiya",
  "伊丹市": "itami",
  "相生市": "aioi",
  "豊岡市": "toyooka",
  "加古川市": "kakogawa",
  "赤穂市": "ako",
  "西脇市": "nishiwaki",
  "宝塚市": "takarazuka",
  "三木市": "miki",
  "高砂市": "takasago",
  "川西市": "kawanishi",
  "小野市": "ono",
  "三田市": "sanda",
  "加西市": "kasai",
  "丹波篠山市": "tanbasasayama",
  "養父市": "yabu",
  "丹波市": "tanba",
  "南あわじ市": "minamiawaji",
  "朝来市": "asago",
  "淡路市": "awaji",
  "宍粟市": "shiso",
  "加東市": "kato",
  "たつの市": "tatsuno",

  // 広島県
  "広島市中区": "hiroshima-naka",
  "広島市東区": "hiroshima-higashi",
  "広島市南区": "hiroshima-minami",
  "広島市西区": "hiroshima-nishi",
  "広島市安佐南区": "hiroshima-asaminami",
  "広島市安佐北区": "hiroshima-asakita",
  "広島市安芸区": "hiroshima-aki",
  "広島市佐伯区": "hiroshima-saeki",
  "呉市": "kure",
  "竹原市": "takehara",
  "三原市": "mihara",
  "尾道市": "onomichi",
  "福山市": "fukuyama",
  "府中市": "fuchu-hiroshima",
  "三次市": "miyoshi-hiroshima",
  "庄原市": "shobara",
  "大竹市": "otake",
  "東広島市": "higashihiroshima",
  "廿日市市": "hatsukaichi",
  "安芸高田市": "akitakata",
  "江田島市": "etajima",

  // 静岡県
  "静岡市葵区": "shizuoka-aoi",
  "静岡市駿河区": "shizuoka-suruga",
  "静岡市清水区": "shizuoka-shimizu",
  "浜松市中央区": "hamamatsu-chuo",
  "浜松市浜名区": "hamamatsu-hamana",
  "浜松市中区": "hamamatsu-naka",
  "浜松市東区": "hamamatsu-higashi",
  "浜松市西区": "hamamatsu-nishi",
  "浜松市南区": "hamamatsu-minami",
  "浜松市北区": "hamamatsu-kita",
  "浜松市天竜区": "hamamatsu-tenryu",
  "沼津市": "numazu",
  "熱海市": "atami",
  "三島市": "mishima",
  "富士宮市": "fujinomiya",
  "伊東市": "ito",
  "島田市": "shimada",
  "富士市": "fuji",
  "磐田市": "iwata",
  "焼津市": "yaizu",
  "掛川市": "kakegawa",
  "藤枝市": "fujieda",
  "御殿場市": "gotemba",
  "袋井市": "fukuroi",
  "下田市": "shimoda",
  "裾野市": "susono",
  "湖西市": "kosai",
  "伊豆市": "izu",
  "御前崎市": "omaezaki",
  "菊川市": "kikugawa",
  "伊豆の国市": "izunokuni",
  "牧之原市": "makinohara",

  // 栃木県
  "宇都宮市": "utsunomiya",
  "足利市": "ashikaga",
  "栃木市": "tochigi",
  "佐野市": "sano",
  "鹿沼市": "kanuma",
  "日光市": "nikko",
  "小山市": "oyama",
  "真岡市": "moka",
  "大田原市": "otawara",
  "矢板市": "yaita",
  "那須塩原市": "nasushiobara",
  "さくら市": "sakura-tochigi",
  "那須烏山市": "nasukarasuyama",
  "下野市": "shimotsuke",

  // 群馬県
  "前橋市": "maebashi",
  "高崎市": "takasaki",
  "桐生市": "kiryu",
  "伊勢崎市": "isesaki",
  "太田市": "ota",
  "沼田市": "numata",
  "館林市": "tatebayashi",
  "渋川市": "shibukawa",
  "藤岡市": "fujioka",
  "富岡市": "tomioka",
  "安中市": "annaka",
  "みどり市": "midori",
}

/**
 * Get municipality slug from Japanese name
 * @param name - Japanese municipality name
 * @returns URL-friendly slug or null if not found
 */
export function getMunicipalitySlug(name: string): string | null {
  const normalizedName = normalizeMunicipalityName(name)
  return municipalitySlugMap[normalizedName] || null
}

/**
 * Get municipality name from slug
 * @param slug - URL-friendly slug
 * @returns Japanese municipality name or null if not found
 */
export function getMunicipalityName(slug: string): string | null {
  const entry = Object.entries(municipalitySlugMap).find(([_, s]) => s === slug)
  return entry ? entry[0] : null
}

/**
 * Normalize municipality name for consistent matching
 * @param name - Municipality name to normalize
 * @returns Normalized municipality name
 */
function normalizeMunicipalityName(name: string): string {
  return name
    .trim()
    .replace(/ヶ/g, 'ケ')  // Normalize ヶ to ケ
    .replace(/ケ/g, 'ケ')  // Ensure consistent ケ
    .replace(/ヵ/g, 'カ')  // Normalize ヵ to カ
    .replace(/〈/g, '(')   // Normalize special brackets
    .replace(/〉/g, ')')
}
